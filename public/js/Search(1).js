define(["jquery","initializer","routesList"],function(e){var t=this,a=e("#formSearch"),s=a.find("input"),n=a.find(".formSearch__clear"),r=a.find(".btnsearch");return e(document).ready(function(){a.on("submit",function(e){e.preventDefault()}),r.on("click",function(){t.goFirst()}),s.on("keyup",function(s){if(13!==s.which){var r=e(this).val();n.toggle(!!r),a.data("has-result",!!r),r?t.getResult(r):a.find(".b-fndtable-container").hide()}else t.goFirst()}),n.on("click",function(){s.val("").trigger("keyup")}),e(document).on("click",function(t){var s=e(t.target);s.closest("form").is(a)&&!s.hasClass("formSearch__clear")?a.find(".js-founded-result").toggle(a.data("has-result")):a.find(".b-fndtable-container").hide()})}),t.getResult=function(s){var n=a.data("uri")+"?q="+encodeURIComponent(s);e.ajax({type:"GET",url:n,beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",a.data("token"))},dataType:"json",success:function(e){var a=e.items||[];t.showResult(a,s)}})},t.showResult=function(s,n){var r=e("<table></table>").addClass("tblFndNum").attr("width","100%");e.each(s,function(t,a){var s=Routing.generate("search_by_number",{manufacturer:a.manufacturer.brand.toLowerCase().replace(/[^a-zа-яё0-9]/,"-"),vendorCode:a.vendor_code.toLowerCase().replace(/[^a-zа-яё0-9]/,"")}),i=e("<tr></tr>").addClass("fast-results__trow").attr("onclick","window.location.href='"+s+"'"),l='<td class="fast-results__tdata ellipsis fast-results__tdata_number">    <a href="'+s+'" class="fast-results__link">        '+a.manufacturer.brand+'    </a></td><td class="fast-results__tdata ellipsis fast-results__tdata_number">    <a href="'+s+'">        '+a.vendor_code.replace(new RegExp("("+n+")","ig"),"$1".bold())+'    </a></td><td class="fast-results__tdata">    <a href="'+s+'">        '+a.name.replace(new RegExp("("+n+")","ig"),"$1".bold())+"    </a></td>";i.append(l),r.append(i)}),e("#js-search-result").empty().append(r),a.find(".js-not-found-result").toggle(!s.length),a.find(".js-founded-result").toggle(!!s.length),a.data("has-result",!!s.length),t.resizeScrollbar()},t.resizeScrollbar=function(){var e=a.find(".js-founded-result"),t=e.find(".fast-results"),s=parseInt(e.find("table").height())+parseInt(e.find(".fast-results__title").height());parseInt(t.height())<s?(t.find(".ps__scrollbar-y-rail").css("display","block"),t.css("padding-right","9px")):(t.find(".ps__scrollbar-y-rail").css("display","none"),t.css("padding-right","0"))},t.goFirst=function(){window.location.href=Routing.generate("search",{q:s.val().replace(new RegExp(/[\/ ]+/g)," ").trim()})},t});